---
/**
 * Notification Component
 *
 * @description A versatile notification component with support for different types and ARIA roles
 */

interface Props {
  /**
   * Additional classes to apply to the Notification
   */
  class?: string
  /**
   * Notification message
   */
  message?: string
  /**
   * Type of notification
   * @default "default"
   */
  type?: 'info' | 'success' | 'warning' | 'error' | 'default'
  /**
   * Variant of the notification
   * @default "default"
   */
  variant?: 'default' | 'accent'
  /**
   * Semantic element to use for the notification
   * @default "div"
   *
   * **When to use div (default):**
   * - System feedback (errors, success, status messages)
   * - User action responses
   * - Dynamic notifications that appear/disappear
   *
   * **When to use aside:**
   * - Educational content related to main content
   * - Tips, explanations, or supplementary information
   * - Content that enhances but isn't essential to understanding
   *
   * @example
   * ```astro
   * <!-- System notification (default) -->
   * <Notification role="alert" type="error">
   *   Please fix the validation errors
   * </Notification>
   *
   * <!-- Educational callout -->
   * <Notification element="aside" role="region">
   *   <h3>Pro Tip</h3>
   *   <p>This technique works especially well...</p>
   * </Notification>
   * ```
   */
  element?: 'div' | 'aside'
  /**
   * ARIA role for the notification
   * @default "none"
   * Note: 'status' implies aria-live="polite", 'alert' implies aria-live="assertive"
   */
  role?: 'none' | 'alert' | 'log' | 'marquee' | 'status' | 'timer' | 'region'
  /**
   * HTML attributes to spread on the notification
   */
  [key: string]: string | number | boolean | undefined
}

const {
  class: className,
  message = 'This is a notification!',
  type = 'default',
  variant = 'default',
  element = 'div',
  role = 'none',
  ...rest
} = Astro.props

// Dynamic element based on prop
const Element = element as any
---

<Element
  class:list={['notification', `type-${type}`, `variant-${variant}`, className]}
  role={role}
  {...rest}
>
  {
    variant === 'accent' && (
      <span class="icon">
        {type === 'default' && (
          <svg
            width="1.25em"
            height="1.25em"
            viewBox="0 0 24 24"
            aria-hidden="true"
            focusable="false"
          >
            <path
              fill="none"
              stroke="currentColor"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M10.268 21a2 2 0 0 0 3.464 0m-10.47-5.674A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326"
            />
          </svg>
        )}
        {type === 'info' && (
          <svg
            width="1.25em"
            height="1.25em"
            viewBox="0 0 24 24"
            aria-hidden="true"
            focusable="false"
          >
            <g
              fill="none"
              stroke="currentColor"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
            >
              <circle cx="12" cy="12" r="10" />
              <path d="M12 16v-4m0-4h.01" />
            </g>
          </svg>
        )}
        {type === 'success' && (
          <svg
            width="1.25em"
            height="1.25em"
            viewBox="0 0 24 24"
            aria-hidden="true"
            focusable="false"
          >
            <g
              fill="none"
              stroke="currentColor"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
            >
              <circle cx="12" cy="12" r="10" />
              <path d="m9 12l2 2l4-4" />
            </g>
          </svg>
        )}
        {type === 'warning' && (
          <svg
            width="1.25em"
            height="1.25em"
            viewBox="0 0 24 24"
            aria-hidden="true"
            focusable="false"
          >
            <path
              fill="none"
              stroke="currentColor"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="m21.73 18l-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3M12 9v4m0 4h.01"
            />
          </svg>
        )}
        {type === 'error' && (
          <svg
            width="1.25em"
            height="1.25em"
            viewBox="0 0 24 24"
            aria-hidden="true"
            focusable="false"
          >
            <g
              fill="none"
              stroke="currentColor"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
            >
              <circle cx="12" cy="12" r="10" />
              <path d="m15 9l-6 6m0-6l6 6" />
            </g>
          </svg>
        )}
      </span>
    )
  }
  <slot>
    <p><strong>Message:</strong> {message}</p>
  </slot>
</Element>

<style>
  :where(.notification) {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    border: 2px solid;
    border-radius: 0.5rem;
    padding: 1rem;
  }

  /* Default */
  :where(.notification) {
    border-color: var(--color-default-border);
    background-color: var(--color-default-bg);
    color: var(--color-default-text);
  }

  /* Info */
  :where(.notification.type-info) {
    border-color: var(--color-info-border);
    background-color: var(--color-info-bg);
    color: var(--color-info-text);
  }

  /* Success */
  :where(.notification.type-success) {
    border-color: var(--color-success-border);
    background-color: var(--color-success-bg);
    color: var(--color-success-text);
  }

  /* Warning */
  :where(.notification.type-warning) {
    border-color: var(--color-warning-border);
    background-color: var(--color-warning-bg);
    color: var(--color-warning-text);
  }

  /* Error */
  :where(.notification.type-error) {
    border-color: var(--color-error-border);
    background-color: var(--color-error-bg);
    color: var(--color-error-text);
  }

  :where(.notification.variant-accent) {
    position: relative;
    border: none;
    padding-inline-start: 1.25rem;
  }

  :where(.notification .icon) {
    position: absolute;
    flex-shrink: 0;
    transform: translate(calc(-50% - 3px), -50%);
    inset-block-start: 0;
    inset-inline-start: 0;
    border-radius: 50%;
    background-color: var(
      --background-color,
      light-dark(oklch(from #b9bec4 100% 0 0), oklch(from #b9bec4 15% c h))
    );
    padding: var(--space-3xs);
  }

  .notification.variant-accent::before {
    position: absolute;
    inset-block-start: 0;
    inset-inline-start: 0;
    border-left: 6px solid;
    border-top-left-radius: 0.5rem;
    border-bottom-left-radius: 0.5rem;
    block-size: 100%;
    content: '';
  }

  .notification.variant-accent.type-info::before {
    border-color: var(--color-info-border);
  }

  .notification.variant-accent.type-success::before {
    border-color: var(--color-success-border);
  }

  .notification.variant-accent.type-warning::before {
    border-color: var(--color-warning-border);
  }

  .notification.variant-accent.type-error::before {
    border-color: var(--color-error-border);
  }

  .notification.variant-accent.type-default::before {
    border-color: var(--color-default-border);
  }

  :where(.notification svg) :global(svg) {
    flex-shrink: 0;
  }
</style>
